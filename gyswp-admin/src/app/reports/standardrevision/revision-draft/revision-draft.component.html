<page-header title={{title}}></page-header>
<nz-card [nzBordered]="false" *ngIf="docInfo" class="info_card_margin">
    <sv-container size="small" col="3" class="mb-md">
        <sv label="标准编号">{{docInfo.docNo}}</sv>
        <sv label="标准文档">
            {{docInfo.name}}

        </sv>
        <sv label="归口部门">{{docInfo.deptName}}</sv>
        <sv label="标准分类">{{docInfo.categoryDesc}}</sv>
        <sv label="标准状态"><label *ngIf="docStamps" style="color:red">[{{docStamps}}]</label></sv>
        <sv label="发布时间">{{docInfo.publishTime | date: "yyyy-MM-dd"}}</sv>
        <sv *ngIf="docInfo.creatorUserName" label="创建人">{{docInfo.creatorUserName}}</sv>
        <sv label="创建时间">{{docInfo.creationTime | date: "yyyy-MM-dd"}}</sv>
    </sv-container>
    <div nz-row>
        <nz-table #expandTable [nzData]="listOfMapData" [nzShowPagination]="false" [nzFrontPagination]="false">
            <thead>
                <tr>
                    <th nzWidth="20%">条款编号</th>
                    <th nzWidth="15%">条款标题</th>
                    <th>条款内容</th>
                    <th nzWidth="10%" *ngIf="type == '4'">创建人</th>
                    <th nzWidth="10%" *ngIf="type == '4'">类型</th>
                    <th nzWidth="15%">操作</th>
                </tr>
            </thead>
            <tbody>
                <ng-container *ngFor="let data of expandTable.data">
                    <ng-container *ngFor="let item of mapOfExpandedData[data.id]">
                        <tr *ngIf="(item.parent && item.parent.expand) || !item.parent"
                            [ngClass]="{ 'true': item.checked == true}">
                            <td [nzIndentSize]="item.level * 20" [nzShowExpand]="item.children.length>0"
                                [(nzExpand)]="item.expand"
                                (nzExpandChange)="collapse(mapOfExpandedData[data.id], item, $event)">
                                {{ item.clauseNo +'  '}}<nz-tag *ngIf="type =='4' && item.isRoot" [nzColor]="'#2db7f5'">
                                    当前采用</nz-tag>
                            </td>
                            <td>{{ item.title | lengthLimit:20}}</td>
                            <td>
                                {{ item.content| lengthLimit:50 }}
                            </td>
                            <td *ngIf="type == '4'">
                                {{ item.creatorUserName}}
                            </td>
                            <td *ngIf="type == '4'">
                                <nz-badge *ngIf="item.revisionType == 1" [nzStatus]="'success'" [nzText]="'新增'">
                                </nz-badge>
                                <nz-badge *ngIf="item.revisionType == 2" [nzStatus]="'processing'" [nzText]="'修订'">
                                </nz-badge>
                                <nz-badge *ngIf="item.revisionType == 3" [nzStatus]="'error'" [nzText]="'删除'">
                                </nz-badge>
                                <nz-badge *ngIf="item.revisionType == 4" [nzStatus]="'success'" [nzText]="'制定'">
                                </nz-badge>
                            </td>
                            <td>
                                <a *ngIf="!editMode" (click)="showDetail(item.id)">详情</a>
                            </td>
                        </tr>
                    </ng-container>
                </ng-container>
            </tbody>
        </nz-table>
    </div>
    <footer-toolbar>
        <button nz-button [nzType]="'default'" (click)="return()">
            返回
        </button>
    </footer-toolbar>
</nz-card>